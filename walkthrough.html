
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Complete walkthrough of a simple example &#8212; NL_2D_FEM 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Code use" href="gui.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="complete-walkthrough-of-a-simple-example">
<span id="walkthrough"></span><h1>Complete walkthrough of a simple example<a class="headerlink" href="#complete-walkthrough-of-a-simple-example" title="Permalink to this heading">¶</a></h1>
<p>This example outlines the step-by-step procedure to compute the benchmark reference solution of
a clamped-clamped beam with a point periodic force,
found in <a class="reference external" href="https://link.springer.com/article/10.1007/s11071-019-05021-6">(A. Givois et al., 2019)</a>.</p>
<section id="set-the-matlab-path">
<h2>Set the Matlab Path<a class="headerlink" href="#set-the-matlab-path" title="Permalink to this heading">¶</a></h2>
<p>First run the <code class="xref py py-mod docutils literal notranslate"><span class="pre">set_src_path</span></code> from the <code class="xref py py-mod docutils literal notranslate"><span class="pre">NonLinearFEM</span></code> folder.</p>
</section>
<section id="create-a-new-fe-model">
<h2>Create a new FE model<a class="headerlink" href="#create-a-new-fe-model" title="Permalink to this heading">¶</a></h2>
<p>Next, create a new folder.
Then, create a new script name <code class="xref py py-mod docutils literal notranslate"><span class="pre">run_problem</span></code> that will contain all of the operations to be done.</p>
<p>In the script, clean the state of Matlab:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clear</span>
<span class="n">close</span> <span class="nb">all</span>
<span class="n">clc</span>
<span class="o">%</span> <span class="n">dont</span> <span class="n">forget</span> <span class="n">to</span> <span class="nb">set</span> <span class="n">the</span> <span class="n">path</span> <span class="p">(</span><span class="n">run</span> <span class="n">set_src_path</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">NonLinearFEM</span> <span class="n">folder</span><span class="p">)</span>
</pre></div>
</div>
<p>Then create a new FE model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span> <span class="n">FEM</span> <span class="n">model</span> <span class="n">definition</span>
<span class="o">%</span> <span class="n">create</span> <span class="n">a</span> <span class="n">new</span> <span class="n">NL_2D_FEM</span> <span class="n">model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NL_2D_FEM</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="input-definition">
<h2>Input definition<a class="headerlink" href="#input-definition" title="Permalink to this heading">¶</a></h2>
<p>The best way to define the inputs is to use a model data structure. However, we also describe how to build the model manually using the initialization methods of the <code class="xref py py-mod docutils literal notranslate"><span class="pre">NL_2D_FEM</span></code> class.</p>
<section id="using-a-model-data-structure">
<h3>Using a model data structure<a class="headerlink" href="#using-a-model-data-structure" title="Permalink to this heading">¶</a></h3>
<p>The model can be created by first building a model data structure. An example model is shown in the file <code class="xref py py-mod docutils literal notranslate"><span class="pre">arthur_beam_problem</span></code>. Then the FE model is directly set up.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">load</span> <span class="n">the</span> <span class="n">model</span> <span class="n">data</span> <span class="n">structure</span>
<span class="n">mds</span> <span class="o">=</span> <span class="n">arthur_beam_problem</span><span class="p">();</span>
<span class="o">%</span> <span class="nb">set</span> <span class="n">up</span> <span class="n">the</span> <span class="n">model</span> <span class="n">using</span> <span class="n">the</span> <span class="n">data</span> <span class="n">structure</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">set_model_from_mds</span><span class="p">(</span><span class="n">mds</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="manual-input-definition">
<h3>Manual input definition<a class="headerlink" href="#manual-input-definition" title="Permalink to this heading">¶</a></h3>
<section id="geometry">
<h4>Geometry<a class="headerlink" href="#geometry" title="Permalink to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">Key</span> <span class="n">nodes</span>
<span class="n">geom_node</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span>   <span class="o">%</span> <span class="n">Point</span> <span class="mi">1</span> <span class="n">coord</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
                         <span class="mi">2</span> <span class="n">L</span><span class="o">/</span><span class="n">pi</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">;</span> <span class="o">%</span> <span class="n">Point</span> <span class="mi">2</span> <span class="n">coord</span> <span class="p">(</span><span class="n">L</span><span class="o">/</span><span class="n">pi</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">%</span> <span class="k">for</span> <span class="n">force</span>
                         <span class="mi">3</span>  <span class="n">L</span>  <span class="mi">0</span> <span class="mi">0</span><span class="p">;];</span><span class="o">%</span> <span class="n">Point</span> <span class="mi">3</span> <span class="n">coord</span> <span class="p">(</span><span class="n">L</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="o">%</span> <span class="n">Lines</span> <span class="n">of</span> <span class="n">the</span> <span class="n">geometry</span>
<span class="n">geom_element</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">2</span>    <span class="o">%</span> <span class="n">line</span> <span class="mi">1</span> <span class="n">between</span> <span class="n">point</span> <span class="mi">1</span> <span class="ow">and</span> <span class="mi">2</span>
                                <span class="mi">2</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">];</span>  <span class="o">%</span> <span class="n">line</span> <span class="mi">2</span> <span class="n">between</span> <span class="n">point</span> <span class="mi">2</span> <span class="ow">and</span> <span class="mi">3</span>
<span class="o">%</span> <span class="n">Discretisation</span> <span class="k">for</span> <span class="n">each</span> <span class="n">line</span>
<span class="n">discretisation</span> <span class="o">=</span> <span class="p">[</span><span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">];</span> <span class="o">%</span> <span class="n">line</span> <span class="mi">1</span> <span class="n">discretized</span> <span class="k">with</span> <span class="mi">15</span> <span class="n">elements</span>
<span class="o">%</span> <span class="nb">set</span> <span class="n">geometry</span> <span class="p">(</span><span class="n">optional</span> <span class="k">if</span> <span class="n">a</span> <span class="n">mesh</span> <span class="ow">is</span> <span class="n">directly</span> <span class="n">provided</span><span class="p">)</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">set_geom</span><span class="p">(</span><span class="n">geom_node</span><span class="p">,</span> <span class="n">geom_element</span><span class="p">,</span> <span class="n">discretisation</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="mesh">
<h4>Mesh<a class="headerlink" href="#mesh" title="Permalink to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="nb">set</span> <span class="n">compute</span> <span class="n">a</span> <span class="n">mesh</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">auto_mesh</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="properties">
<h4>Properties<a class="headerlink" href="#properties" title="Permalink to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">Key</span> <span class="n">nodes</span>
<span class="o">%%</span> <span class="n">material</span> <span class="n">inputs</span> <span class="o">+</span> <span class="n">adimentionalization</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">50</span><span class="p">;</span> <span class="n">h</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>  <span class="o">%</span> <span class="n">constant</span> <span class="n">relative</span> <span class="n">to</span> <span class="n">the</span> <span class="n">beam</span> <span class="n">section</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">h</span><span class="p">;</span>       <span class="o">%</span> <span class="n">section</span> <span class="n">area</span>
<span class="n">I</span> <span class="o">=</span> <span class="n">b</span><span class="o">*</span><span class="n">h</span><span class="o">^</span><span class="mi">3</span><span class="o">/</span><span class="mi">12</span><span class="p">;</span>  <span class="o">%</span> <span class="n">section</span> <span class="n">second</span> <span class="n">moment</span> <span class="n">of</span> <span class="n">area</span>
<span class="n">rho</span> <span class="o">=</span> <span class="mf">7.8e-9</span><span class="p">;</span>  <span class="o">%</span> <span class="n">material</span> <span class="n">density</span>
<span class="n">E</span> <span class="o">=</span> <span class="mf">210e3</span><span class="p">;</span>     <span class="o">%</span> <span class="n">material</span> <span class="n">Young</span> <span class="n">Modulus</span>
<span class="n">poisson</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>  <span class="o">%</span> <span class="n">material</span> <span class="n">Poisson</span> <span class="n">ratio</span>
<span class="n">k</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>           <span class="o">%</span> <span class="n">shear</span> <span class="n">area</span> <span class="n">coeff</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">;</span>   <span class="o">%</span> <span class="n">Raileight</span> <span class="n">damping</span> <span class="n">coeff</span> <span class="p">(</span><span class="n">C</span> <span class="o">=</span> <span class="n">alpha</span> <span class="n">M</span><span class="p">)</span>
<span class="o">%</span> <span class="nb">set</span> <span class="n">properties</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">set_prop</span><span class="p">(</span><span class="n">S</span><span class="p">,</span> <span class="n">I</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">E</span><span class="p">,</span> <span class="n">poisson</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">alpha</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="boundary-conditions">
<h4>Boundary conditions<a class="headerlink" href="#boundary-conditions" title="Permalink to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span> <span class="n">Boundary</span> <span class="n">condition</span> <span class="nb">input</span> <span class="p">(</span><span class="n">Dirichlet</span> <span class="n">condition</span> <span class="n">only</span><span class="p">)</span>
<span class="n">mds</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">bc_node_list</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">=</span> <span class="n">struct</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="s1">&#39;dof&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="o">%</span> <span class="n">node</span> <span class="mi">1</span> <span class="ow">is</span> <span class="n">clamped</span>
<span class="n">mds</span><span class="o">.</span><span class="n">boundary</span><span class="o">.</span><span class="n">bc_node_list</span><span class="p">{</span><span class="mi">2</span><span class="p">}</span> <span class="o">=</span> <span class="n">struct</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="s1">&#39;dof&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]);</span> <span class="o">%</span> <span class="n">node</span> <span class="mi">3</span> <span class="ow">is</span> <span class="n">clamped</span>
<span class="o">%</span> <span class="nb">set</span> <span class="n">boundary</span> <span class="n">condition</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">set_boundary</span><span class="p">(</span><span class="n">bc_node_list</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="visualization">
<h4>Visualization<a class="headerlink" href="#visualization" title="Permalink to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span> <span class="n">Visualisation</span> <span class="n">node</span> <span class="n">Input</span> <span class="p">(</span><span class="k">for</span> <span class="n">results</span> <span class="n">display</span><span class="p">)</span>
<span class="n">visu_node_list</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">=</span> <span class="n">struct</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="mi">2</span> <span class="p">,</span><span class="o">...</span>
                                                <span class="s1">&#39;dof&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span><span class="p">]);</span>
<span class="o">%</span> <span class="nb">set</span> <span class="n">visualized</span> <span class="n">nodes</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">set_visu</span><span class="p">(</span><span class="n">visu_node_list</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="force-definitions">
<h4>Force definitions<a class="headerlink" href="#force-definitions" title="Permalink to this heading">¶</a></h4>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">point</span> <span class="n">periodic</span> <span class="n">force</span>
<span class="n">periodic_ponctual_force_node_list</span><span class="p">{</span><span class="mi">1</span><span class="p">}</span> <span class="o">=</span> <span class="n">struct</span><span class="p">(</span><span class="s1">&#39;node&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span><span class="s1">&#39;dof&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span><span class="s1">&#39;amplitude&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">],</span> <span class="s1">&#39;harmonic&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="o">+</span><span class="mi">1</span><span class="n">i</span><span class="p">]</span> <span class="p">);</span> <span class="o">%</span> <span class="nb">complex</span> <span class="n">amplitude</span> <span class="n">f</span> <span class="o">=</span> <span class="n">re</span><span class="p">(</span><span class="n">amp</span><span class="p">)</span> <span class="n">cos</span> <span class="o">+</span> <span class="n">im</span><span class="p">(</span><span class="n">amp</span><span class="p">)</span> <span class="n">sin</span>
<span class="o">%</span> <span class="n">dynamic</span> <span class="n">loads</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">set_periodic_loads</span><span class="p">(</span><span class="s1">&#39;ponctual&#39;</span><span class="p">,</span> <span class="n">periodic_ponctual_force_node_list</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="matrices-and-force-vector-initialization">
<h2>Matrices and force vector initialization<a class="headerlink" href="#matrices-and-force-vector-initialization" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">assemble</span> <span class="n">mass</span> <span class="n">matrix</span> <span class="ow">and</span> <span class="n">force</span> <span class="n">vector</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">initialise_matrices_and_vector</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="static-solution">
<h2>Static solution<a class="headerlink" href="#static-solution" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">static</span> <span class="n">solution</span>
<span class="p">[</span><span class="n">qs_full</span><span class="p">,</span> <span class="n">res</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">solve_static_problem</span><span class="p">();</span>
<span class="n">q0_full</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">vectors</span><span class="o">.</span><span class="n">null_vector</span><span class="p">;</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="mi">99</span><span class="p">);</span> <span class="n">fig</span><span class="o">.</span><span class="n">Name</span><span class="o">=</span><span class="s1">&#39;Static configuration&#39;</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot_deformed_mesh</span><span class="p">(</span><span class="n">q0_full</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;--k&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="n">undef</span> <span class="n">mesh</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot_deformed_mesh</span><span class="p">(</span><span class="n">qs_full</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="s1">&#39;-c&#39;</span><span class="p">)</span> <span class="o">%</span> <span class="k">def</span> <span class="nf">mesh</span>
<span class="o">%</span> <span class="n">compute</span> <span class="n">stresses</span>
<span class="p">[</span><span class="n">strain</span><span class="p">,</span><span class="n">stress</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">strains_and_stress_at_gauss_point</span><span class="p">(</span><span class="n">qs_full</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="modal-analysis">
<h2>Modal analysis<a class="headerlink" href="#modal-analysis" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">modal</span> <span class="n">analysis</span>
<span class="p">[</span><span class="n">shape</span><span class="p">,</span> <span class="n">freq</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">linear_modal_analysis</span><span class="p">(</span><span class="n">qs_full</span><span class="p">);</span>
<span class="o">%</span> <span class="p">[</span><span class="n">shape</span><span class="p">,</span> <span class="n">freq</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">linear_modal_analysis</span><span class="p">();</span>
<span class="n">fig2</span> <span class="o">=</span> <span class="n">figure</span><span class="p">(</span><span class="mi">98</span><span class="p">);</span> <span class="n">fig2</span><span class="o">.</span><span class="n">Name</span><span class="o">=</span><span class="s1">&#39;Mode Shapes&#39;</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot_deformed_mesh</span><span class="p">(</span><span class="n">q0_full</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="s1">&#39;--k&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot_deformed_mesh</span><span class="p">(</span><span class="n">qs_full</span><span class="p">,</span> <span class="n">fig2</span><span class="p">,</span> <span class="s1">&#39;-c&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot_deformed_mesh</span><span class="p">(</span><span class="n">shape</span><span class="p">(:,</span><span class="mi">1</span><span class="p">),</span> <span class="n">fig2</span><span class="p">,</span> <span class="s1">&#39;-r&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot_deformed_mesh</span><span class="p">(</span><span class="n">shape</span><span class="p">(:,</span><span class="mi">2</span><span class="p">),</span> <span class="n">fig2</span><span class="p">,</span> <span class="s1">&#39;-g&#39;</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">plot_deformed_mesh</span><span class="p">(</span><span class="n">shape</span><span class="p">(:,</span><span class="mi">3</span><span class="p">),</span> <span class="n">fig2</span><span class="p">,</span> <span class="s1">&#39;-b&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="linear-forced-analysis">
<h2>Linear forced analysis<a class="headerlink" href="#linear-forced-analysis" title="Permalink to this heading">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span> <span class="n">linear</span> <span class="n">analysis</span>
<span class="n">H</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">target_mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="n">Omega</span> <span class="o">=</span> <span class="n">linspace</span><span class="p">(</span><span class="n">freq</span><span class="p">(</span><span class="n">target_mode</span><span class="p">)</span><span class="o">*</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">freq</span><span class="p">(</span><span class="n">target_mode</span><span class="p">)</span><span class="o">*</span><span class="mf">1.2</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">;</span>
<span class="p">[</span><span class="n">qp_full</span><span class="p">,</span> <span class="n">bode</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">linear_analysis</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">Omega</span><span class="p">,</span> <span class="n">qs_full</span><span class="p">);</span>
<span class="n">figure</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="o">%</span> <span class="n">first</span> <span class="n">harmonic</span> <span class="n">amplitude</span><span class="p">;</span> <span class="n">hold</span> <span class="n">on</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Omega</span><span class="p">,</span> <span class="n">bode</span><span class="o">.</span><span class="n">amp_qp_full</span><span class="p">{</span><span class="mi">1</span><span class="p">}(</span><span class="mi">4</span><span class="p">,:))</span> <span class="o">%</span> <span class="n">u</span> <span class="n">node</span> <span class="mi">2</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Omega</span><span class="p">,</span> <span class="n">bode</span><span class="o">.</span><span class="n">amp_qp_full</span><span class="p">{</span><span class="mi">1</span><span class="p">}(</span><span class="mi">5</span><span class="p">,:))</span> <span class="o">%</span> <span class="n">v</span> <span class="n">node</span> <span class="mi">2</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Omega&#39;</span><span class="p">);</span> <span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amp H1&#39;</span><span class="p">)</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="n">first</span> <span class="n">harmonic</span> <span class="n">phase</span><span class="p">;</span> <span class="n">hold</span> <span class="n">on</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Omega</span><span class="p">,</span> <span class="n">bode</span><span class="o">.</span><span class="n">phase_qp_full</span><span class="p">{</span><span class="mi">1</span><span class="p">}(</span><span class="mi">5</span><span class="p">,:))</span> <span class="o">%</span> <span class="n">phase</span> <span class="n">u</span> <span class="n">node</span> <span class="mi">2</span>
<span class="n">plot</span><span class="p">(</span><span class="n">Omega</span><span class="p">,</span> <span class="n">bode</span><span class="o">.</span><span class="n">phase_qp_full</span><span class="p">{</span><span class="mi">1</span><span class="p">}(</span><span class="mi">5</span><span class="p">,:))</span> <span class="o">%</span> <span class="n">phase</span> <span class="n">v</span> <span class="n">node</span> <span class="mi">2</span>
<span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Omega&#39;</span><span class="p">);</span> <span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Phase H1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="manlab-analysis">
<h2>MANLAB analysis<a class="headerlink" href="#manlab-analysis" title="Permalink to this heading">¶</a></h2>
<section id="manlab-inputs">
<h3>MANLAB inputs<a class="headerlink" href="#manlab-inputs" title="Permalink to this heading">¶</a></h3>
<p>Define the MANLAB input data and initialize the MAN system:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span> <span class="n">MANLAB</span> <span class="n">LAUNCHING</span> <span class="n">SEQUENCE</span>
<span class="o">%%</span> <span class="n">MANLAB</span> <span class="n">INPUTS</span>
<span class="k">global</span> <span class="n">U</span> <span class="n">Section</span> <span class="n">Diagram</span>   <span class="o">%</span> <span class="n">Global</span> <span class="n">variables</span> <span class="n">to</span> <span class="n">export</span> <span class="n">point</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">diagram</span><span class="o">.</span>
<span class="n">H</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>          <span class="o">%</span> <span class="n">number</span> <span class="n">of</span> <span class="n">harmonics</span> <span class="k">for</span> <span class="n">the</span> <span class="n">Fourier</span> <span class="n">series</span>
<span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;autonomous&#39;</span><span class="p">;</span> <span class="o">%</span> <span class="nb">type</span> <span class="n">of</span> <span class="n">system</span> <span class="p">(</span><span class="n">can</span> <span class="n">be</span> <span class="s1">&#39;forced&#39;</span> <span class="ow">or</span> <span class="s1">&#39;autonomous&#39;</span><span class="p">)</span>
<span class="o">%</span> <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;forced&#39;</span><span class="p">;</span> <span class="o">%</span> <span class="nb">type</span> <span class="n">of</span> <span class="n">system</span> <span class="p">(</span><span class="n">can</span> <span class="n">be</span> <span class="s1">&#39;forced&#39;</span> <span class="ow">or</span> <span class="s1">&#39;autonomous&#39;</span><span class="p">)</span>
<span class="n">target_mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="o">%</span> <span class="n">modeto</span> <span class="n">be</span> <span class="n">studied</span> <span class="ow">in</span> <span class="n">NNM</span> <span class="p">(</span><span class="n">autonomous</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">in</span> <span class="n">FRF</span> <span class="p">(</span><span class="n">forced</span><span class="p">)</span>
<span class="n">angfreq</span> <span class="o">=</span> <span class="s1">&#39;omega&#39;</span><span class="p">;</span> <span class="o">%</span> <span class="s1">&#39;omega&#39;</span> <span class="ow">or</span> <span class="n">constant</span> <span class="n">value</span>
<span class="o">%%</span> <span class="n">Use</span> <span class="n">the</span> <span class="n">model</span> <span class="n">to</span> <span class="n">initialise</span> <span class="n">MANLAB</span> <span class="n">computation</span> <span class="n">automatically</span>
<span class="o">%</span> <span class="n">MANLAB</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">parameters</span> <span class="k">for</span> <span class="n">equation</span><span class="o">.</span><span class="n">m</span>
<span class="p">[</span><span class="n">nz</span><span class="p">,</span> <span class="n">nz_aux</span><span class="p">,</span> <span class="n">parameters</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">set_MAN_parameters</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span>  <span class="n">model</span><span class="p">,</span> <span class="n">angfreq</span><span class="p">);</span>
<span class="o">%</span> <span class="n">Construct</span> <span class="n">MANLAB</span> <span class="n">system</span> <span class="p">(</span><span class="n">matlab</span> <span class="nb">object</span><span class="p">)</span>
<span class="n">sys</span> <span class="o">=</span> <span class="n">SystHBQ</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span><span class="n">nz_aux</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="nd">@equations_vector_NL_2D_FEM</span><span class="p">,</span><span class="nd">@point_display</span><span class="p">,</span><span class="nd">@global_display</span><span class="p">,</span><span class="n">parameters</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="s1">&#39;vectorial&#39;</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="nonlinear-normal-modes-starting-point">
<h3>Nonlinear normal modes starting point<a class="headerlink" href="#nonlinear-normal-modes-starting-point" title="Permalink to this heading">¶</a></h3>
<p>Find the starting point for the nonlinear modes MANLAB computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">omega0</span> <span class="o">=</span> <span class="p">(</span><span class="n">freq</span><span class="p">(</span><span class="n">target_mode</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="p">);</span>
<span class="n">lambda0</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">getcoord</span><span class="p">(</span><span class="s1">&#39;cos&#39;</span><span class="p">,</span><span class="mi">2</span> <span class="p">,</span><span class="mi">1</span><span class="p">);</span> <span class="o">%</span> <span class="n">dof</span> <span class="n">to</span> <span class="n">be</span> <span class="n">imposed</span> <span class="n">amplitude</span>
<span class="n">amp</span> <span class="o">=</span> <span class="mf">1e-5</span><span class="p">;</span>    <span class="o">%</span> <span class="n">imposed</span> <span class="n">amplitude</span>
<span class="p">[</span><span class="n">Z0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">man_initial_point</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">omega0</span><span class="p">,</span> <span class="n">qs_full</span><span class="p">,</span> <span class="n">amp</span><span class="o">*</span><span class="n">shape</span><span class="p">(:,</span><span class="n">target_mode</span><span class="p">));</span>
<span class="n">U0</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">init_U0</span><span class="p">(</span><span class="n">Z0</span><span class="p">,</span> <span class="n">omega0</span><span class="p">,</span> <span class="n">lambda0</span><span class="p">);</span>
<span class="n">U0</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">solve_MAN_system_at_fixed_amplitude</span><span class="p">(</span><span class="n">U0</span><span class="p">,</span> <span class="n">idx</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">sys</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="forced-response-starting-point">
<h3>Forced response starting point<a class="headerlink" href="#forced-response-starting-point" title="Permalink to this heading">¶</a></h3>
<p>Find the starting point for the forced response MANLAB computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">omega0</span> <span class="o">=</span> <span class="n">freq</span><span class="p">(</span><span class="n">target_mode</span><span class="p">)</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">pi</span><span class="o">*</span><span class="mf">0.8</span><span class="p">;</span>
<span class="n">lambda0</span> <span class="o">=</span> <span class="n">omega0</span><span class="p">;</span> <span class="o">%</span> <span class="n">continuation</span> <span class="n">parameter</span> <span class="n">initial</span> <span class="n">value</span>
<span class="p">[</span><span class="n">qp_full</span><span class="p">,</span> <span class="n">bode</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">linear_analysis</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">omega0</span><span class="p">);</span>
<span class="p">[</span><span class="n">Z0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">man_initial_point</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">omega0</span><span class="p">,</span> <span class="n">qs_full</span><span class="p">,</span> <span class="n">qp_full</span><span class="p">);</span>
<span class="n">U0</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">init_U0</span><span class="p">(</span><span class="n">Z0</span><span class="p">,</span> <span class="n">omega0</span><span class="p">,</span> <span class="n">lambda0</span><span class="p">);</span>
<span class="n">U0</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">solve_MAN_system_at_fixed_frequency</span><span class="p">(</span><span class="n">U0</span><span class="p">,</span> <span class="n">omega0</span><span class="p">,</span> <span class="n">sys</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="display-variables-and-call-to-manlab">
<h3>Display variables and call to MANLAB<a class="headerlink" href="#display-variables-and-call-to-manlab" title="Permalink to this heading">¶</a></h3>
<p>Choose the display variables visualized during the computation and call MANLAB:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%%</span> <span class="n">Variable</span> <span class="n">displayed</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">projected</span> <span class="n">bifurcation</span> <span class="n">diagram</span><span class="o">.</span>
<span class="o">%</span> <span class="n">To</span> <span class="n">plot</span> <span class="n">the</span> <span class="n">coefficient</span> <span class="n">of</span> <span class="n">cos</span><span class="p">(</span><span class="n">h</span> <span class="n">omega</span> <span class="n">t</span><span class="p">)</span> <span class="n">of</span> <span class="n">variable</span> <span class="n">number</span> <span class="n">i</span> <span class="k">with</span>
<span class="o">%</span> <span class="n">respect</span> <span class="n">to</span> <span class="k">lambda</span> <span class="n">you</span> <span class="n">should</span> <span class="n">write</span> <span class="k">as</span> <span class="n">follows</span><span class="p">:</span>
<span class="n">dispvars</span> <span class="o">=</span> <span class="p">[</span><span class="n">sys</span><span class="o">.</span><span class="n">getcoord</span><span class="p">(</span><span class="s1">&#39;omega&#39;</span><span class="p">)</span> <span class="n">sys</span><span class="o">.</span><span class="n">getcoord</span><span class="p">(</span><span class="s1">&#39;cos&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">getcoord</span><span class="p">(</span><span class="s1">&#39;omega&#39;</span><span class="p">)</span> <span class="n">sys</span><span class="o">.</span><span class="n">getcoord</span><span class="p">(</span><span class="s1">&#39;sin&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">getcoord</span><span class="p">(</span><span class="s1">&#39;omega&#39;</span><span class="p">)</span> <span class="n">sys</span><span class="o">.</span><span class="n">getcoord</span><span class="p">(</span><span class="s1">&#39;cos&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
                        <span class="n">sys</span><span class="o">.</span><span class="n">getcoord</span><span class="p">(</span><span class="s1">&#39;omega&#39;</span><span class="p">)</span> <span class="n">sys</span><span class="o">.</span><span class="n">getcoord</span><span class="p">(</span><span class="s1">&#39;sin&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)];</span>
<span class="o">%%</span> <span class="n">Launch</span> <span class="n">of</span> <span class="n">Manlab</span> <span class="k">with</span> <span class="n">options</span>
<span class="n">Manlab</span><span class="p">(</span><span class="s1">&#39;sys&#39;</span>       <span class="p">,</span><span class="n">sys</span> <span class="p">,</span> <span class="o">...</span>
        <span class="s1">&#39;U0value&#39;</span>         <span class="p">,</span><span class="n">U0</span><span class="p">,</span> <span class="o">...</span>
        <span class="s1">&#39;order&#39;</span>           <span class="p">,</span><span class="mi">20</span><span class="p">,</span> <span class="o">...</span>     <span class="o">%</span> <span class="n">order</span> <span class="n">of</span> <span class="n">the</span> <span class="n">series</span>
        <span class="s1">&#39;ANMthreshold&#39;</span>    <span class="p">,</span><span class="mf">1e-10</span><span class="p">,</span> <span class="o">...</span>   <span class="o">%</span> <span class="n">threshold</span> <span class="k">for</span> <span class="n">the</span> <span class="n">domain</span> <span class="n">of</span> <span class="n">validity</span> <span class="n">of</span> <span class="n">the</span> <span class="n">series</span>
        <span class="s1">&#39;Amax_max&#39;</span>        <span class="p">,</span><span class="mf">1e2</span><span class="p">,</span> <span class="o">...</span>    <span class="o">%</span> <span class="n">maximum</span> <span class="n">value</span> <span class="n">of</span> <span class="n">the</span> <span class="n">domain</span> <span class="n">of</span> <span class="n">validity</span> <span class="n">of</span> <span class="n">the</span> <span class="n">series</span>
        <span class="s1">&#39;NRthreshold&#39;</span>     <span class="p">,</span><span class="mf">1e-12</span><span class="p">,</span> <span class="o">...</span>   <span class="o">%</span> <span class="n">threshold</span> <span class="k">for</span> <span class="n">Newton</span><span class="o">-</span><span class="n">Raphson</span> <span class="p">(</span><span class="n">NR</span><span class="p">)</span> <span class="n">corrections</span>
        <span class="s1">&#39;NRitemax&#39;</span>        <span class="p">,</span><span class="mi">50</span><span class="p">,</span> <span class="o">...</span>     <span class="o">%</span> <span class="n">Maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">iteration</span> <span class="n">of</span> <span class="n">NR</span> <span class="n">algorithm</span>
        <span class="s1">&#39;NRstart&#39;</span>         <span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span>      <span class="o">%</span> <span class="n">NR</span> <span class="n">corrections</span> <span class="k">for</span> <span class="n">the</span> <span class="n">user</span><span class="o">-</span><span class="n">defined</span> <span class="n">starting</span> <span class="n">point</span> <span class="p">[</span><span class="n">on</span><span class="p">]</span><span class="o">/</span><span class="n">off</span>
        <span class="s1">&#39;NRmethod&#39;</span>        <span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span>      <span class="o">%</span> <span class="n">NR</span> <span class="n">corrections</span> <span class="n">on</span><span class="o">/</span><span class="p">[</span><span class="n">off</span><span class="p">]</span>
        <span class="s1">&#39;BifDetection&#39;</span>    <span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="o">...</span>      <span class="o">%</span> <span class="n">Detection</span> <span class="n">of</span> <span class="n">bifurcation</span> <span class="p">[</span><span class="n">on</span><span class="p">]</span><span class="o">/</span><span class="n">off</span>
        <span class="s1">&#39;PointDisplay&#39;</span>    <span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span>      <span class="o">%</span> <span class="n">Point</span> <span class="n">display</span> <span class="p">[</span><span class="n">on</span><span class="p">]</span><span class="o">/</span><span class="n">off</span>
        <span class="s1">&#39;GlobalDisplay&#39;</span>   <span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span>      <span class="o">%</span> <span class="n">Global</span> <span class="n">display</span> <span class="p">[</span><span class="n">on</span><span class="p">]</span><span class="o">/</span><span class="n">off</span>
        <span class="s1">&#39;StabilityCheck&#39;</span>  <span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span>      <span class="o">%</span> <span class="n">Stability</span> <span class="n">computation</span> <span class="n">on</span><span class="o">/</span><span class="p">[</span><span class="n">off</span><span class="p">]</span>
        <span class="s1">&#39;StabTol&#39;</span>         <span class="p">,</span><span class="mf">1e-6</span><span class="p">,</span> <span class="o">...</span>   <span class="o">%</span> <span class="n">Stability</span> <span class="n">tolerance</span>
        <span class="s1">&#39;displayvariables&#39;</span><span class="p">,</span><span class="n">dispvars</span><span class="p">);</span>     <span class="o">%</span> <span class="n">MANLAB</span> <span class="n">run</span>
</pre></div>
</div>
</section>
</section>
<section id="quick-launch-of-a-computation">
<h2>Quick launch of a computation<a class="headerlink" href="#quick-launch-of-a-computation" title="Permalink to this heading">¶</a></h2>
<p>In what follows, all of the previous elementary functions have been used to provide a quick way to start a MANLAB computation.</p>
<section id="define-the-model">
<h3>Define the model<a class="headerlink" href="#define-the-model" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">clear</span>
<span class="n">close</span> <span class="nb">all</span>
<span class="n">clc</span>
<span class="o">%%</span> <span class="n">Path</span> <span class="n">of</span> <span class="n">the</span> <span class="n">SRC</span> <span class="n">file</span><span class="o">.</span>
<span class="n">addpath</span><span class="p">(</span><span class="n">genpath</span><span class="p">(</span><span class="s1">&#39;..\..\..\SRC&#39;</span><span class="p">));</span>
<span class="n">addpath</span><span class="p">(</span><span class="n">genpath</span><span class="p">(</span><span class="s1">&#39;..\..\NonlinearDyn_vectorialform&#39;</span><span class="p">));</span>
<span class="o">%%</span> <span class="n">FEM</span> <span class="n">model</span> <span class="n">definition</span>
<span class="o">%</span> <span class="n">load</span> <span class="n">the</span> <span class="n">model</span> <span class="n">data</span> <span class="n">structure</span>
<span class="n">mds</span> <span class="o">=</span> <span class="n">toy_house_problem</span><span class="p">();</span>
<span class="o">%</span> <span class="n">create</span> <span class="n">a</span> <span class="n">new</span> <span class="n">NL_2D_FEM</span> <span class="n">model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">NL_2D_FEM</span><span class="p">;</span>
<span class="o">%</span> <span class="nb">set</span> <span class="n">up</span> <span class="n">the</span> <span class="n">model</span> <span class="n">using</span> <span class="n">the</span> <span class="n">data</span> <span class="n">structure</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">set_model_from_mds</span><span class="p">(</span><span class="n">mds</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="initialize-the-computation">
<h3>Initialize the computation<a class="headerlink" href="#initialize-the-computation" title="Permalink to this heading">¶</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%%</span> <span class="n">MANLAB</span> <span class="n">LAUNCHING</span> <span class="n">SEQUENCE</span>
<span class="o">%%</span> <span class="n">MANLAB</span> <span class="n">INPUTS</span>
<span class="k">global</span> <span class="n">U</span> <span class="n">Section</span> <span class="n">Diagram</span>   <span class="o">%</span> <span class="n">Global</span> <span class="n">variables</span> <span class="n">to</span> <span class="n">export</span> <span class="n">point</span> <span class="kn">from</span> <span class="nn">the</span> <span class="n">diagram</span> <span class="ow">in</span> <span class="n">GUI</span>
<span class="n">H</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>          <span class="o">%</span> <span class="n">number</span> <span class="n">of</span> <span class="n">harmonics</span> <span class="k">for</span> <span class="n">the</span> <span class="n">Fourier</span> <span class="n">series</span>
<span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;autonomous&#39;</span><span class="p">;</span> <span class="o">%</span> <span class="nb">type</span> <span class="n">of</span> <span class="n">system</span> <span class="p">(</span><span class="n">can</span> <span class="n">be</span> <span class="s1">&#39;forced&#39;</span> <span class="ow">or</span> <span class="s1">&#39;autonomous&#39;</span><span class="p">)</span>
<span class="o">%</span> <span class="nb">type</span> <span class="o">=</span> <span class="s1">&#39;forced&#39;</span><span class="p">;</span> <span class="o">%</span> <span class="nb">type</span> <span class="n">of</span> <span class="n">system</span> <span class="p">(</span><span class="n">can</span> <span class="n">be</span> <span class="s1">&#39;forced&#39;</span> <span class="ow">or</span> <span class="s1">&#39;autonomous&#39;</span><span class="p">)</span>
<span class="n">target_mode</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="o">%</span> <span class="n">modeto</span> <span class="n">be</span> <span class="n">studied</span> <span class="ow">in</span> <span class="n">NNM</span> <span class="p">(</span><span class="n">autonomous</span><span class="p">)</span> <span class="ow">or</span> <span class="ow">in</span> <span class="n">FRF</span> <span class="p">(</span><span class="n">forced</span><span class="p">)</span>
<span class="n">angfreq</span> <span class="o">=</span> <span class="s1">&#39;omega&#39;</span><span class="p">;</span> <span class="o">%</span> <span class="s1">&#39;omega&#39;</span> <span class="ow">or</span> <span class="n">constant</span> <span class="n">value</span>
<span class="o">%</span> <span class="n">MANLAB</span> <span class="n">structure</span> <span class="n">of</span> <span class="n">parameters</span> <span class="k">for</span> <span class="n">equation</span><span class="o">.</span><span class="n">m</span>
<span class="p">[</span><span class="n">nz</span><span class="p">,</span> <span class="n">nz_aux</span><span class="p">,</span> <span class="n">parameters</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">set_MAN_parameters</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span>  <span class="n">model</span><span class="p">,</span> <span class="n">angfreq</span><span class="p">);</span>
<span class="o">%</span> <span class="n">Construct</span> <span class="n">MANLAB</span> <span class="n">system</span> <span class="p">(</span><span class="n">matlab</span> <span class="nb">object</span><span class="p">)</span>
<span class="n">sys</span> <span class="o">=</span> <span class="n">SystHBQ</span><span class="p">(</span><span class="n">nz</span><span class="p">,</span><span class="n">nz_aux</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="nd">@equations_vector_NL_2D_FEM</span><span class="p">,</span><span class="nd">@point_display</span><span class="p">,</span><span class="nd">@global_display</span><span class="p">,</span><span class="n">parameters</span><span class="p">,</span><span class="nb">type</span><span class="p">,</span><span class="s1">&#39;vectorial&#39;</span><span class="p">);</span>
<span class="o">%%</span> <span class="n">compute</span> <span class="n">static</span> <span class="n">equilibrium</span><span class="p">,</span> <span class="n">modal</span> <span class="n">analysis</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">MANLAB</span> <span class="n">starting</span> <span class="n">point</span>
<span class="p">[</span><span class="n">U0</span><span class="p">,</span> <span class="n">omega0</span><span class="p">,</span> <span class="n">lambda0</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">initialise_MAN_computation</span><span class="p">(</span><span class="n">sys</span><span class="p">,</span> <span class="nb">type</span><span class="p">,</span> <span class="n">target_mode</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="call-to-manlab">
<h3>Call to MANLAB<a class="headerlink" href="#call-to-manlab" title="Permalink to this heading">¶</a></h3>
<p>Same as in the detailed version.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">NL_2D_FEM</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="object.html">Description of the <cite>NL_2D_FEM</cite> object</a></li>
<li class="toctree-l1"><a class="reference internal" href="useful.html">Useful functions folder</a></li>
<li class="toctree-l1"><a class="reference internal" href="inputs.html">Description of the inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="gui.html">Code use</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Complete walkthrough of a simple example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#set-the-matlab-path">Set the Matlab Path</a></li>
<li class="toctree-l2"><a class="reference internal" href="#create-a-new-fe-model">Create a new FE model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-definition">Input definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#matrices-and-force-vector-initialization">Matrices and force vector initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#static-solution">Static solution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modal-analysis">Modal analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linear-forced-analysis">Linear forced analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#manlab-analysis">MANLAB analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quick-launch-of-a-computation">Quick launch of a computation</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="gui.html" title="previous chapter">Code use</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Marielle Debeurre, Aurélien Grolet, Olivier Thomas, Bruno Cochelin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/walkthrough.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>