<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of linear_matrix_assembly</title>
  <meta name="keywords" content="linear_matrix_assembly">
  <meta name="description" content="">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">NonlinearDyn_vectorialform</a> &gt; <a href="index.html">Old</a> &gt; linear_matrix_assembly.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for NonlinearDyn_vectorialform\Old&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>linear_matrix_assembly
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong></strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [K_global_lin, M_global_lin, f_ext_global] = linear_matrix_assembly(parameters) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"></pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="linearEigenAnalysis.html" class="code" title="function [parameters, K_global_lin, M_global_lin, K, M, C, omega, V, omega_free, Phi] = linearEigenAnalysis(parameters)">linearEigenAnalysis</a>	K_glob, M_glob full matrices</li></ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [K_global_lin, M_global_lin, f_ext_global] = linear_matrix_assembly(parameters)</a>
0002 
0003 mesh = parameters.mesh;
0004 number_elements = mesh.number_elements;
0005 number_nodes = mesh.number_nodes;
0006 
0007 E = parameters.beam_params.modulus;
0008 A = parameters.beam_params.area;
0009 G = parameters.beam_params.shear;
0010 I = parameters.beam_params.I;
0011 k = parameters.beam_params.k;
0012 rho = parameters.beam_params.density;
0013 
0014 L_element = zeros(number_elements,1);
0015 theta_element = zeros(number_elements,1);
0016 
0017 K_global_lin = zeros(3*number_nodes,3*number_nodes);
0018 M_global_lin =  zeros(3*number_nodes,3*number_nodes);
0019 f_ext_global = zeros(3*number_nodes,1);
0020 
0021 <span class="keyword">for</span> i = 1:number_elements
0022     <span class="keyword">if</span> length(A) &gt; 1 <span class="comment">%%% for special case of A and I not being constant throughout the structure</span>
0023         A = A(i);
0024         I = I(i);
0025     <span class="keyword">end</span>
0026     nodeA  =  mesh.connect(i,2);
0027     nodeB  =  mesh.connect(i,3);
0028     
0029     index_global_A = 3*(nodeA - 1) + [1:3];
0030     index_global_B = 3*(nodeB - 1) + [1:3];
0031 
0032     index = [index_global_A index_global_B];
0033     
0034     [L_element(i), theta_element(i)] = elementOrientation(mesh,i);
0035     rot_matrix = transformationMatrix(theta_element(i));
0036 
0037     <span class="comment">%%% K1 through K7 == Sénéchal's stiffness Keps + Kgam + Kkap when eps =</span>
0038     <span class="comment">%%% gam = kap = 0, c = 1, s = 0 (see Appendix of Thomas, Sénéchal, Deü 2016)</span>
0039     K1 = E*A/L_element(i); 
0040     K3 = 0; 
0041     K4 = 0; 
0042     K2 = k*G*A/L_element(i); 
0043     K5 = k*G*A/2; 
0044     K6 = k*G*A*L_element(i)/4 + E*I/L_element(i);
0045     K7 = k*G*A*L_element(i)/4 - E*I/L_element(i);
0046 
0047     
0048     K_ele_lin = [ K1  K3  K4   -K1 -K3  K4;
0049                   K3  K2  K5   -K3 -K2  K5;
0050                   K4  K5  K6   -K4 -K5  K7;
0051                  -K1 -K3 -K4    K1  K3 -K4;
0052                  -K3 -K2 -K5    K3  K2 -K5;
0053                   K4  K5  K7   -K4 -K5  K6 ];
0054     
0055               
0056     M_ele_lin = (L_element(i)*rho/6)*[  2*A      0      0      A     0     0                                 
0057                                          0      2*A     0      0     A     0           
0058                                          0       0     2*I     0     0     I        
0059                                          A       0      0     2*A    0     0
0060                                          0       A      0      0    2*A    0
0061                                          0       0      I      0     0    2*I ];
0062                                      
0063     f_ext_elem = [0; L_element(i); 0; 0; L_element(i); 0];
0064     
0065     K_global_lin(index,index) = K_global_lin(index,index) + rot_matrix*K_ele_lin*rot_matrix';
0066     M_global_lin(index,index) = M_global_lin(index,index) + rot_matrix*M_ele_lin*rot_matrix';
0067     f_ext_global(index,:) = f_ext_global(index,:) + rot_matrix*f_ext_elem; <span class="comment">% distributed external force</span>
0068 <span class="keyword">end</span>
0069 
0070 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Mon 17-Oct-2022 20:14:50 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>