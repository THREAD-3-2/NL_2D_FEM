<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of linearEigenAnalysis</title>
  <meta name="keywords" content="linearEigenAnalysis">
  <meta name="description" content="K_glob, M_glob full matrices">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../../index.html">Home</a> &gt;  <a href="../index.html">NonlinearDyn_vectorialform</a> &gt; <a href="index.html">Old</a> &gt; linearEigenAnalysis.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../../index.html"><img alt="<" border="0" src="../../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for NonlinearDyn_vectorialform\Old&nbsp;<img alt=">" border="0" src="../../right.png"></a></td></tr></table>-->

<h1>linearEigenAnalysis
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>K_glob, M_glob full matrices</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="box"><strong>function [parameters, K_global_lin, M_global_lin, K, M, C, omega, V, omega_free, Phi] = linearEigenAnalysis(parameters) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre class="comment"> K_glob, M_glob full matrices
 M, K, C matrices taking into acount BC (reduced size)
 Phi, omega_free : free modes
 V, omega : modes taking into account BC</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../../matlabicon.gif)">
<li><a href="linear_matrix_assembly.html" class="code" title="function [K_global_lin, M_global_lin, f_ext_global] = linear_matrix_assembly(parameters)">linear_matrix_assembly</a>	</li></ul>
This function is called by:
<ul style="list-style-image:url(../../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [parameters, K_global_lin, M_global_lin, K, M, C, omega, V, omega_free, Phi] = linearEigenAnalysis(parameters)</a>
0002 <span class="comment">% K_glob, M_glob full matrices</span>
0003 <span class="comment">% M, K, C matrices taking into acount BC (reduced size)</span>
0004 <span class="comment">% Phi, omega_free : free modes</span>
0005 <span class="comment">% V, omega : modes taking into account BC</span>
0006 
0007 <span class="comment">%%%</span>
0008 [K_global_lin, M_global_lin, f_ext_global] = <a href="linear_matrix_assembly.html" class="code" title="function [K_global_lin, M_global_lin, f_ext_global] = linear_matrix_assembly(parameters)">linear_matrix_assembly</a>(parameters);
0009 
0010 <span class="comment">% free linear modes</span>
0011 [Phi,D] = eig(K_global_lin, M_global_lin);
0012 [omega_free, idx] = sort(sqrt(diag(D)), <span class="string">'ascend'</span>);
0013 Phi = Phi(:,idx);
0014 
0015 <span class="comment">% modal analysis with boundary conditions</span>
0016 prescribed_dof = parameters.dof_info.bc.prescribed_dof;
0017 M = M_global_lin;
0018 K = K_global_lin;
0019 M(prescribed_dof,:) = [ ];  <span class="comment">% remove rows with fixed dof</span>
0020 M(:,prescribed_dof) = [ ];  <span class="comment">% remove columns with fixed dof</span>
0021 K(prescribed_dof,:) = [ ];
0022 K(:,prescribed_dof) = [ ];
0023 f_ext_global(prescribed_dof) = [ ];
0024 
0025 
0026 [V, D] = eig(K, M); 
0027 [omega, idx] = sort(sqrt(diag(D)), <span class="string">'ascend'</span>);
0028 V = V(:,idx);
0029 
0030 <span class="comment">% linear damping matrix</span>
0031 <span class="keyword">if</span> strcmp(parameters.beam_params.damping.type,<span class="string">'Rayleigh'</span>)
0032 <span class="comment">%     C = parameters.beam_params.damping.alpha * M + parameters.beam_params.damping.beta * K;</span>
0033    alpha = 2 * parameters.beam_params.damping.xi0 * omega(parameters.mode);
0034    beta = 0;
0035    C = alpha * M + beta * K;
0036 <span class="keyword">elseif</span> strcmp(parameters.beam_params.damping.type,<span class="string">'Modal'</span>)
0037 <span class="comment">%     C = M * V * parameters.beam_params.damping.Xi * transpose(V) * M;</span>
0038     parameters.beam_params.damping.Xi(parameters.mode,parameters.mode) = parameters.beam_params.damping.Xi_mode; <span class="comment">% reduce damping at selected mode</span>
0039 <span class="comment">%     parameters.beam_params.damping.Xi(2:11,2:11) = parameters.beam_params.damping.Xi_increased*eye(10); % increase damping on first 10 transverse modes only</span>
0040 <span class="comment">%     parameters.beam_params.damping.Xi = parameters.beam_params.damping.Xi./(2*omega); % checking that Modal = Raleigh</span>
0041     C = M * V * 2 * parameters.beam_params.damping.Xi * diag(omega) * transpose(V) * M;
0042 <span class="keyword">else</span>
0043     disp(<span class="string">'error: undefined damping type'</span>)
0044     <span class="keyword">return</span>
0045 <span class="keyword">end</span>
0046 
0047 <span class="comment">% recast to full size, with zeros at BC dof position</span>
0048 C_global_lin = zeros(size(M_global_lin));
0049 C_global_lin(parameters.dof_info.active, parameters.dof_info.active) = C;
0050 
0051 <span class="comment">% put the matrices inside the structure</span>
0052 parameters.M_glob = M_global_lin;
0053 parameters.K_glob = K_global_lin;
0054 parameters.C_glob = C_global_lin;
0055 parameters.f_ext_glob = f_ext_global;
0056 <span class="keyword">end</span>
0057</pre></div>
<hr><address>Generated on Mon 17-Oct-2022 20:14:50 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>